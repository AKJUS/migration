---
steps:
- commands:
  - "# No need for cloning, the agent takes care of that"
  - "./build-app.sh"
  - git clone git@github.com:example/example-repository /tmp/bitrise-ex
  - "./build-app.sh"
  - |-
    curl -X POST \
    -H "Authorization: token $GITHUB_TOKEN" \
    -H "Accept: application/vnd.github.v3+json" \
    -H "Content-Type: application/octet-stream" \
    --data-binary @/tmp/bitrise-ex/artifacts/app-debug.apk \
    https://uploads.github.com/repos/example/example-repository/releases/assets?name=app-debug.apk
  - |-
    curl -X POST \
    -H "Authorization: token $GITHUB_TOKEN" \
    -H "Accept: application/vnd.github.v3+json" \
    -H "Content-Type: application/octet-stream" \
    --data-binary @/tmp/bitrise-ex/artifacts/app-debug-androidTest.apk \
    https://uploads.github.com/repos/example/example-repository/releases/assets?name=app-debug-androidTest.apk
  label: build
  key: build
- commands:
  - "# No need for cloning, the agent takes care of that"
  - git clone git@github.com:example/example-repository /tmp/bitrise-ex
  - "./build-app.sh"
  - |-
    curl -X POST \
    -H "Authorization: token $GITHUB_TOKEN" \
    -H "Accept: application/vnd.github.v3+json" \
    -H "Content-Type: application/octet-stream" \
    --data-binary @/tmp/bitrise-ex/artifacts/app-debug.apk \
    https://uploads.github.com/repos/example/example-repository/releases/assets?name=app-debug.apk
  - |-
    curl -X POST \
    -H "Authorization: token $GITHUB_TOKEN" \
    -H "Accept: application/vnd.github.v3+json" \
    -H "Content-Type: application/octet-stream" \
    --data-binary @/tmp/bitrise-ex/artifacts/app-debug-androidTest.apk \
    https://uploads.github.com/repos/example/example-repository/releases/assets?name=app-debug-androidTest.apk
  label: test
  key: test
