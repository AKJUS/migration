---
steps:
- commands:
  - "# No need for checkout, the agent takes care of that"
  - echo '~~~ Install Dependencies'
  - apt-get update
  - apt-get install -y curl jq git
  - "#!/usr/bin/env bash"
  - ''
  - if [[ $EUID == 0 ]]; then export SUDO=""; else export SUDO="sudo"; fi
  - ''
  - "# Creating custom installation directory"
  - "$SUDO mkdir -p /usr/bin"
  - ''
  - "# Installing specific Docker version: 20.10.7"
  - VERSION=20.10.7
  - curl -fsSL https://download.docker.com/linux/static/stable/x86_64/docker-${VERSION}.tgz
    -o docker.tgz
  - tar xzvf docker.tgz
  - "$SUDO cp docker/* /usr/bin/"
  - rm -rf docker docker.tgz
  - ''
  plugins:
  - docker#v5.10.0:
      image: cimg/base:stable
  agents:
    executor_type: docker
  key: install-docker
